# 1장 근접성 서비스


### 기능 요구사항

1. 사용자의 위치(경도와 위도 쌍)와 검색 반경 정보에 매치되는 사업장 목록 반환

2. 사업장 소유주가 사업장 정보를 추가, 삭제, 갱신 가능. 그 정보는 실시간 반영 될 필요 없음

3. 사업장 상세 정보 조회 가능


### 비기능 요구사항

- 낮은 응답 지연(Latency), 고가용성(high availability) -> Redis 적용 고려 지점

![image](https://github.com/somefood/cs-study/assets/45227809/826c499f-5217-4662-af69-b8d4dac164a7)


로드 밸런서의 도입 이유 : 대부분의 사용자 요청은 LBS(위치 기반 서비스)에서 발생한다. 또한 트래픽이 집중 되는 시간(점심, 저녁, 주말) 시간에 특정 서버를 추가하여 대응하는 방안도 있다. 이를 위해 로드 밸런서를 설계에 포함한다.

### 데이터 베이스 규모의 확장성 - 샤딩의 도입 여부

사업장 테이블 - 사업장에 대한 세부 정보가 포함되므로, 한 서버에 담을 수 없을 수 있다. 즉 샤딩 적용 후보
지리 정보 색인 테이블 - 데이터 증가의 폭이 크지 않을 것으로 예상된다. 즉 샤딩이 불필요 할 수 있다.

### 캐시 - Redis의 도입

Redis 도입 시 고려해 야 할 측면, **벤치 마킹**과 비용 분석

실제로, Redis 도입이 성능 향상에 도움이 되는지 데이터 베이스 증설을 통한 읽기 대역폭 증가로 해결가능 한 지 분석

#### Latency(지연시간)

- 네트워크에서 하나의 데이터 패킷이 한 지점에서 다른 지점으로 보내지는 데 소요되는 시간을 말한다.
- 보통 요청이 왔을 때 요청을 처리하고 응답할 때까지의 시간을 말한다.
- 일반적으로 Latency는 두 네트워크의 거리가 멀 때 높아진다.
- 한 지점의 부하가 높아지면, 높아진다.

  ![image](https://github.com/somefood/cs-study/assets/45227809/50176a17-6d89-439a-9b32-635ebaf8a392)


##### Throughput (처리량)

- 서버가 감당할 수 있는 number of request
- 일정 시간 동안 처리하는 작업의 양이다.
- 즉 한 서버의 처리량이 증가하면, 부하가 증가한다.

![image](https://github.com/somefood/cs-study/assets/45227809/778075fb-eb72-4c10-a347-46988bce1cbe)



### 최종 설계 모델

1. 로드 밸랜서를 통해 애플리케이션 부하를 조정한다.
2. RDB 복제를 통해 쓰기와 읽기 부하를 분산한다.
3. 캐시(Redis) 도입을 통해 Latency를 분산한다.

![image](https://github.com/somefood/cs-study/assets/45227809/6204ffc1-49ad-42d2-9392-fbc56b929651)

